# 중소기업 재무진단 시스템

## 🎯 프로젝트 개요

**신용보증기금 재무비율 기준**을 활용한 중소기업 자동 재무진단 시스템입니다. 재무제표를 입력하면 자동으로 12개 주요 재무비율을 계산하고, 업종 평균과 비교하여 신용보증 가능성을 평가합니다.

### 주요 기능

- ✅ **재무비율 자동 계산**: 12개 핵심 지표 완벽 산출
  - **유동성**: 유동비율, 당좌비율
  - **안정성**: 부채비율, 자기자본비율
  - **수익성**: 매출액영업이익률, 매출액순이익률, ROA, ROE
  - **활동성**: 총자산회전율, 재고자산회전율, 매출채권회전율, 이자보상배율
- ✅ **업종별 벤치마킹**: 신용보증기금 공식 업종평균 데이터 기반 비교 분석
- ✅ **리스크 평가**: HIGH/MEDIUM/LOW 3단계 위험도 자동 판정
- ✅ **맞춤형 권고사항**: 개선이 필요한 재무지표별 구체적 조언 제공 (12개 지표별 세분화)
- ✅ **진단 이력 관리**: 과거 진단 결과 저장 및 추적
- ✅ **사용자 편의**: 천단위 콤마 자동 표시, 직관적 입력 폼
- ✅ **신보 표준지표 조회**: 업종별/규모별/연도별 신용보증기금 표준 재무비율 확인
- ✅ **계산식 안내**: 12개 재무비율의 계산 공식 및 평가 기준 상세 설명

## 🌐 배포 URL

- **🚀 프로덕션 (Cloudflare Pages)**: https://sme-financial-diagnosis.pages.dev
- **개발 서버**: https://3000-iz9isfoa1wiovn6biofxf-de59bda9.sandbox.novita.ai
- **GitHub**: https://github.com/lsw2696/sme-financial-diagnosis

### 페이지
- `/` - 메인 재무진단 페이지 (천단위 콤마 입력)
- `/standards` - 신보 업종별 표준지표 조회 (필터링 기능)
- `/formulas` - 재무비율 계산식 안내 (12개 지표)
- `/test` - 숫자 입력 테스트 페이지

### API 엔드포인트
- `GET /api/industries` - 업종코드 목록 (52개)
- `GET /api/standards` - 신보 표준지표 전체 조회 (42개)
- `POST /api/diagnose` - 재무진단 수행
- `GET /api/history` - 진단 이력 조회

## 📊 데이터 아키텍처

### 주요 데이터 모델

1. **업종코드 테이블 (industry_codes)**
   - 한국표준산업분류 기준 50여개 업종 코드
   - 제조업, 건설업, 도소매업, IT, 서비스업 등 전업종 포함

2. **신보 재무비율 기준 (sinbo_ratios)**
   - 업종별 × 기업규모별 × 연도별 평균 재무비율
   - 2022~2023년 데이터 42건 (외감/비외감 구분)
   - 유동비율, 부채비율, 수익성, 활동성 지표 포함

3. **진단 이력 (diagnosis_history)**
   - 회사별 진단 결과 자동 저장
   - 재무제표 원본 데이터 + 계산 비율 + 진단 결과 JSON

### 저장 서비스

- **Cloudflare D1 Database**: SQLite 기반 로컬/프로덕션 데이터베이스
- **로컬 개발**: `.wrangler/state/v3/d1` 경로에 자동 생성
- **마이그레이션**: `migrations/0001_initial_schema.sql`로 스키마 관리

## 💡 사용 가이드

### 1️⃣ 재무제표 준비

다음 항목을 재무제표에서 확인하세요 (단위: 백만원):
- **필수 항목**: 매출액, 유동자산, 유동부채, 총자산, 총부채, 자기자본, 영업이익, 당기순이익
- **선택 항목**: 재고자산, 매출채권, 이자비용 (입력 시 추가 비율 계산)
- **입력 팁**: 숫자 입력 시 자동으로 천단위 콤마가 표시됩니다 (예: 5000 → 5,000)

### 2️⃣ 입력 및 진단

1. 웹사이트 접속
2. 회사명, 업종, 연도, 기업규모(외감/비외감) 선택
3. 재무제표 항목 입력
4. "진단 시작" 버튼 클릭

### 3️⃣ 결과 해석

- **리스크 낮음(LOW)**: 신보 보증 승인 가능성 높음
- **리스크 보통(MEDIUM)**: 일부 개선 후 보증 신청 권장
- **리스크 높음(HIGH)**: 재무구조 개선 필수

각 재무비율별로 업종 평균 대비 수준과 구체적 개선 방안을 제시합니다.

## 🔧 기술 스택

- **Backend**: Hono (TypeScript) + Cloudflare Workers
- **Database**: Cloudflare D1 (SQLite)
- **Frontend**: Vanilla JavaScript + TailwindCSS
- **차트**: Chart.js
- **아이콘**: Font Awesome

## 📁 프로젝트 구조

```
webapp/
├── src/
│   ├── index.tsx              # 메인 API 및 UI
│   ├── types.ts               # TypeScript 타입 정의
│   └── utils/
│       ├── calculator.ts      # 재무비율 계산 로직
│       └── diagnosis.ts       # 진단 및 비교 로직
├── migrations/
│   └── 0001_initial_schema.sql  # DB 스키마
├── data/
│   ├── industry_codes.csv     # 업종코드 매핑
│   ├── sinbo_ratios_sample.csv # 신보 기준 데이터
│   └── seed.sql               # 시드 데이터
├── scripts/
│   └── load_sinbo_data.sql    # 신보 데이터 로드
└── wrangler.jsonc             # Cloudflare 설정
```

## 📈 현재 완료된 기능

- ✅ 업종코드 50개 데이터베이스 구축
- ✅ 신보 재무비율 기준 데이터 42건 탑재 (2022~2023년)
- ✅ **12개 재무비율 완벽 계산 엔진**
  - 유동비율, 당좌비율
  - 부채비율, 자기자본비율
  - 매출액영업이익률, 매출액순이익률
  - ROA, ROE
  - 총자산회전율, 재고자산회전율, 매출채권회전율, 이자보상배율
- ✅ 업종 평균 비교 알고리즘 (12개 지표 전체)
- ✅ 3단계 리스크 평가 시스템
- ✅ **12개 지표별 맞춤 개선 권고사항** 자동 생성
- ✅ 웹 기반 사용자 인터페이스 (천단위 콤마 자동 표시)
- ✅ **신보 표준지표 조회 페이지** (업종/규모/연도별 필터링)
- ✅ **재무비율 계산식 안내 페이지** (12개 지표 공식 및 평가 기준)
- ✅ 진단 이력 저장 기능

## 🚀 향후 개발 계획

- ⏳ 엑셀 파일 업로드 기능
- ⏳ PDF 진단 리포트 다운로드
- ⏳ 다년도 추세 분석 (시계열 그래프)
- ⏳ 경쟁사 비교 분석
- ⏳ 신보 보증서류 자동 생성
- ⏳ 개선 시뮬레이션 (목표 재무비율 달성 시나리오)

## 🔐 데이터 출처

- **신용보증기금 재무비율 정보**: 공공데이터포털 공식 데이터 기반
- **한국표준산업분류**: 통계청 업종 분류 코드 사용
- 실제 운영 시 최신 데이터로 업데이트 권장

## 📝 개발 정보

- **개발 환경**: Cloudflare Pages + D1 Database
- **프로덕션**: https://sme-financial-diagnosis.pages.dev
- **D1 Database ID**: `128b0ad4-eaf8-4add-8dd9-88ea7d4d2b10`
- **로컬 개발**: `npm run dev:sandbox` (로컬 SQLite 자동 생성)
- **데이터베이스 초기화**: `npm run db:reset`
- **프로덕션 배포**: `npm run deploy` 또는 `wrangler pages deploy dist`

## 💬 고객 지원

재무진단 결과는 참고용이며, 실제 신용보증 신청은 신용보증기금 공식 절차를 따라주세요.

---

**개발자**: 우서기 (컨설턴트/경영지도사/개업공인중개사)  
**프로덕션 URL**: https://sme-financial-diagnosis.pages.dev  
**GitHub**: https://github.com/lsw2696/sme-financial-diagnosis  
**최종 업데이트**: 2025-11-18  
**배포 상태**: ✅ Cloudflare Pages 운영 중

## 🐛 최근 버그 수정 (2025-11-18)

### 수정 완료
1. **표준지표 테이블 업종명 중복 표시** ✅
   - 문제: `/standards` 페이지에서 같은 업종명이 여러 행에 중복 표시됨
   - 해결: rowspan 속성을 placeholder 패턴으로 구현하여 동일 업종은 한 번만 표시
   - 구현: 데이터 정렬 → placeholder 삽입 → 행 카운트 → 최종 교체 방식

2. **숫자 입력 필드 천단위 콤마 포맷팅** ✅
   - 문제: data-number-input 속성의 focus/blur 이벤트에서 콤마가 표시되지 않음
   - 해결: 정규식 패턴 오타 수정 (`\B`, `\d` 역슬래시 추가)
   - 기능: 포커스 시 콤마 제거, 입력 완료 시 자동 콤마 추가
   - 테스트: `/test` 페이지에서 이벤트 로그와 함께 확인 가능
